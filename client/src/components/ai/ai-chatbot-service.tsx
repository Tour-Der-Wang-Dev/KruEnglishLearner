import { apiRequest } from '@/lib/queryClient';

export interface ChatMessage {
  id: string;
  text: string;
  sender: 'user' | 'bot';
  timestamp: Date;
}

export class AIChatbotService {
  private static instance: AIChatbotService;

  static getInstance(): AIChatbotService {
    if (!AIChatbotService.instance) {
      AIChatbotService.instance = new AIChatbotService();
    }
    return AIChatbotService.instance;
  }

  async generateResponse(userMessage: string, language: 'th' | 'en', context?: any): Promise<string> {
    try {
      // First try OpenAI if API key is available
      if (process.env.OPENAI_API_KEY || import.meta.env.VITE_OPENAI_API_KEY) {
        return await this.generateOpenAIResponse(userMessage, language, context);
      }
      
      // Fallback to rule-based responses
      return this.generateRuleBasedResponse(userMessage, language);
    } catch (error) {
      console.error('AI Response Error:', error);
      return this.generateRuleBasedResponse(userMessage, language);
    }
  }

  private async generateOpenAIResponse(userMessage: string, language: 'th' | 'en', context?: any): Promise<string> {
    try {
      const systemPrompt = language === 'th' 
        ? `‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ AI Assistant ‡∏Ç‡∏≠‡∏á Kru English ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≠‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö:
        - ‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: General English (390‡∏ø), CEFR Platinum (790‡∏ø), Combo Small Group (1,390‡∏ø)
        - ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: 09:00-21:00 ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
        - ‡∏Ñ‡∏£‡∏π‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏≤‡∏Å‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤ ‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© ‡∏≠‡∏≠‡∏™‡πÄ‡∏ï‡∏£‡πÄ‡∏•‡∏µ‡∏¢
        - ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô Stripe
        - ‡πÉ‡∏ö‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏ü‡∏¥‡πÄ‡∏Ñ‡∏ï‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÇ‡∏•‡∏Å
        - ‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏î‡∏ú‡πà‡∏≤‡∏ô Zoom
        ‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á`
        : `You are the AI Assistant for Kru English, an online English learning platform. You can help answer questions about:
        - Courses: General English (390 THB), CEFR Platinum (790 THB), Combo Small Group (1,390 THB)
        - Schedule: 09:00-21:00 daily
        - Native teachers from USA, UK, Australia
        - Stripe payment processing
        - International certificates
        - Live Zoom classes
        Answer in English in a friendly and informative manner.`;

      const response = await apiRequest('POST', '/api/ai/chat', {
        message: userMessage,
        language,
        systemPrompt,
        context
      });

      const data = await response.json();
      return data.response || this.generateRuleBasedResponse(userMessage, language);
    } catch (error) {
      throw error;
    }
  }

  private generateRuleBasedResponse(userMessage: string, language: 'th' | 'en'): string {
    const input = userMessage.toLowerCase();
    
    if (language === 'th') {
      // Thai responses
      if (input.includes('‡∏£‡∏≤‡∏Ñ‡∏≤') || input.includes('‡πÅ‡∏û‡∏•‡∏ô') || input.includes('‡πÄ‡∏á‡∏¥‡∏ô')) {
        return `‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡πÅ‡∏û‡∏•‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 3 ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö:
        
üìö **General English** - 390‡∏ø/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
- ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏î‡∏ú‡πà‡∏≤‡∏ô Zoom
- ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ü‡∏£‡∏µ + ‡∏î‡∏π‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á

üèÜ **CEFR Platinum** - 790‡∏ø/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô  
- ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≠‡∏ö CEFR ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÇ‡∏•‡∏Å
- ‡∏Ñ‡∏£‡∏π‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤
- ‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏ü‡∏¥‡πÄ‡∏Ñ‡∏ï

üë• **Combo Small Group** - 1,390‡∏ø/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏•‡πá‡∏Å 8 ‡∏Ñ‡∏ô‡∏ï‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á
- ‡∏ù‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô
- ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î!

üí∞ **‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© 10-20%** ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ã‡∏∑‡πâ‡∏≠ 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ!`;
      }
      
      if (input.includes('‡πÄ‡∏ß‡∏•‡∏≤') || input.includes('‡∏ï‡∏≤‡∏£‡∏≤‡∏á') || input.includes('schedule')) {
        return `‚è∞ **‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô Kru English**

üåÖ **‡πÄ‡∏ä‡πâ‡∏≤**: 09:00 - 12:00
üåû **‡∏ö‡πà‡∏≤‡∏¢**: 13:00 - 17:00  
üåô **‡∏Ñ‡πà‡∏≥**: 18:00 - 21:00

üìÖ **‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô** ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå - ‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå
üì± **‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤** 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
üîÑ **‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô** ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ

‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏´‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö? ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ "‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô"`;
      }
      
      if (input.includes('‡∏Ñ‡∏£‡∏π') || input.includes('teacher') || input.includes('‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå')) {
        return `üë®‚Äçüè´ **‡∏Ñ‡∏£‡∏π‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÇ‡∏•‡∏Å**

üá∫üá∏ **‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤** - American English
üá¨üáß **‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©** - British English  
üá¶üá∫ **‡∏≠‡∏≠‡∏™‡πÄ‡∏ï‡∏£‡πÄ‡∏•‡∏µ‡∏¢** - Australian English

‚úÖ **‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏Ñ‡∏£‡∏π**:
‚Ä¢ ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏™‡∏≠‡∏ô 5+ ‡∏õ‡∏µ
‚Ä¢ ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á TEFL/TESOL
‚Ä¢ ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡∏Ñ‡∏ô‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢
‚Ä¢ ‡∏û‡∏π‡∏î‡πÑ‡∏ó‡∏¢‡πÑ‡∏î‡πâ‡∏û‡∏≠‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£

üéØ **‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö Interactive**
‚Ä¢ ‡∏ù‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á
‚Ä¢ ‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏à‡∏£‡∏¥‡∏á
‚Ä¢ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏±‡∏ô‡∏ó‡∏µ Real-time`;
      }
      
      if (input.includes('‡πÉ‡∏ö‡πÄ‡∏ã‡∏≠‡∏£‡πå') || input.includes('certificate') || input.includes('‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£')) {
        return `üèÜ **‡πÉ‡∏ö‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏ü‡∏¥‡πÄ‡∏Ñ‡∏ï‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÇ‡∏•‡∏Å**

üìú **‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏à‡∏ö‡∏Ñ‡∏≠‡∏£‡πå‡∏™**:
‚Ä¢ ‡πÉ‡∏ö‡πÄ‡∏ã‡∏≠‡∏£‡πå CEFR ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏≤‡∏Å‡∏•
‚Ä¢ ‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®
‚Ä¢ ‡πÉ‡∏ä‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô/‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ

üåü **‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô**:
‚Ä¢ European Framework (CEFR)
‚Ä¢ ‡∏£‡∏∞‡∏î‡∏±‡∏ö A1, A2, B1, B2
‚Ä¢ Digital Certificate ‡∏û‡∏£‡πâ‡∏≠‡∏° QR Code

‚ú® **‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå**:
‚Ä¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
‚Ä¢ ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡πà‡∏≠‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®
‚Ä¢ ‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©`;
      }
      
      if (input.includes('zoom') || input.includes('‡∏Ñ‡∏•‡∏≤‡∏™') || input.includes('‡πÄ‡∏£‡∏µ‡∏¢‡∏ô')) {
        return `üíª **‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏î‡∏ú‡πà‡∏≤‡∏ô Zoom**

üé• **‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏£‡∏∞‡∏î‡∏±‡∏ö HD**:
‚Ä¢ ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ 1080p ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
‚Ä¢ ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ñ‡∏°‡∏ä‡∏±‡∏î ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏∞‡∏î‡∏∏‡∏î
‚Ä¢ ‡πÅ‡∏ä‡∏£‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÑ‡∏î‡πâ

üîß **‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ô**:
‚Ä¢ Breakout Rooms ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏¢‡πà‡∏≠‡∏¢
‚Ä¢ Whiteboard ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô
‚Ä¢ Recording ‡∏î‡∏π‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á 7 ‡∏ß‡∏±‡∏ô

üì± **‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå**:
‚Ä¢ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå / ‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏•‡πá‡∏ï
‚Ä¢ ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iOS/Android
‚Ä¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°`;
      }
      
      if (input.includes('‡∏™‡∏°‡∏±‡∏Ñ‡∏£') || input.includes('‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô') || input.includes('register')) {
        return `üìù **‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏Ñ‡πà 3 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô)**

**1Ô∏è‚É£ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡∏•‡∏ô**
‚Ä¢ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤ "‡∏£‡∏≤‡∏Ñ‡∏≤" 
‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡∏•‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
‚Ä¢ ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢"

**2Ô∏è‚É£ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô**  
‚Ä¢ ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
‚Ä¢ ‡∏ä‡∏≥‡∏£‡∏∞‡∏ú‡πà‡∏≤‡∏ô Stripe (‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)
‚Ä¢ ‡∏£‡∏±‡∏ö‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ó‡∏≤‡∏á Email

**3Ô∏è‚É£ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô**
‚Ä¢ ‡∏£‡∏±‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå Zoom
‚Ä¢ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏≤‡∏™‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤
‚Ä¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!

üí≥ **‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢** SSL Encryption`;
      }
      
      return `‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡∏Ñ‡∏∑‡∏≠ AI Assistant ‡∏Ç‡∏≠‡∏á Kru English ü§ñ

‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö:
‚Ä¢ üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏û‡∏•‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ
‚Ä¢ ‚è∞ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤  
‚Ä¢ üë®‚Äçüè´ ‡∏Ñ‡∏£‡∏π‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô
‚Ä¢ üèÜ ‡πÉ‡∏ö‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏ü‡∏¥‡πÄ‡∏Ñ‡∏ï
‚Ä¢ üì± ‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
‚Ä¢ üíª ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Zoom

‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ "‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤" ‡∏Ñ‡∏£‡∏±‡∏ö üòä`;
    } else {
      // English responses
      if (input.includes('price') || input.includes('cost') || input.includes('plan') || input.includes('fee')) {
        return `üí∞ **Our Course Plans**

üìö **General English** - 390 THB/month
- Perfect for beginners
- Live Zoom classes
- Free materials + recordings

üèÜ **CEFR Platinum** - 790 THB/month
- International CEFR preparation
- Native teachers
- Global certificates

üë• **Combo Small Group** - 1,390 THB/month
- Small groups (8 students max)
- Intensive conversation practice
- Best value!

üéâ **Special Discount 10-20%** for 3+ month plans!`;
      }
      
      if (input.includes('time') || input.includes('schedule') || input.includes('when')) {
        return `‚è∞ **Class Schedule**

üåÖ **Morning**: 09:00 - 12:00
üåû **Afternoon**: 13:00 - 17:00
üåô **Evening**: 18:00 - 21:00

üìÖ **Every day** Monday - Sunday
üì± **Book 24 hours** in advance
üîÑ **Flexible** time changes allowed

Which time works for you? Check detailed schedule in "Schedule" section.`;
      }
      
      if (input.includes('teacher') || input.includes('instructor') || input.includes('native')) {
        return `üë®‚Äçüè´ **World-Class Native Teachers**

üá∫üá∏ **USA** - American English
üá¨üáß **UK** - British English
üá¶üá∫ **Australia** - Australian English

‚úÖ **Teacher Qualifications**:
‚Ä¢ 5+ years teaching experience
‚Ä¢ TEFL/TESOL certified
‚Ä¢ Asian learner specialists
‚Ä¢ Basic Thai communication

üéØ **Interactive Teaching**:
‚Ä¢ Pronunciation training
‚Ä¢ Real-life conversations
‚Ä¢ Real-time corrections`;
      }
      
      if (input.includes('certificate') || input.includes('certification') || input.includes('diploma')) {
        return `üèÜ **International Certificates**

üìú **Upon course completion**:
‚Ä¢ CEFR international certificates
‚Ä¢ Globally recognized
‚Ä¢ Use for jobs/university applications

üåü **Standards**:
‚Ä¢ European Framework (CEFR)
‚Ä¢ Levels A1, A2, B1, B2
‚Ä¢ Digital certificate with QR code

‚ú® **Benefits**:
‚Ä¢ Boost career opportunities
‚Ä¢ University applications abroad
‚Ä¢ Prove English proficiency`;
      }
      
      if (input.includes('zoom') || input.includes('class') || input.includes('online')) {
        return `üíª **Live Zoom Classes**

üé• **HD Quality**:
‚Ä¢ 1080p crystal clear video
‚Ä¢ High-quality audio
‚Ä¢ Smooth connection

üîß **Learning Features**:
‚Ä¢ Breakout rooms for groups
‚Ä¢ Interactive whiteboard
‚Ä¢ 7-day recordings available

üì± **Any Device**:
‚Ä¢ Computer / Tablet
‚Ä¢ iOS/Android mobile
‚Ä¢ No software installation needed`;
      }
      
      if (input.includes('register') || input.includes('signup') || input.includes('enroll') || input.includes('join')) {
        return `üìù **How to Register (3 Easy Steps)**

**1Ô∏è‚É£ Choose Plan**
‚Ä¢ Go to "Pricing" page
‚Ä¢ Select your preferred plan
‚Ä¢ Click "Buy Now"

**2Ô∏è‚É£ Payment**
‚Ä¢ Fill personal information
‚Ä¢ Pay via Stripe (secure)
‚Ä¢ Receive email confirmation

**3Ô∏è‚É£ Start Learning**
‚Ä¢ Receive Zoom links
‚Ä¢ Join class on time
‚Ä¢ Start learning immediately!

üí≥ **Secure Payment** with SSL encryption`;
      }
      
      return `Hello! I'm the Kru English AI Assistant ü§ñ

You can ask me about:
‚Ä¢ üí∞ Pricing and plans
‚Ä¢ ‚è∞ Schedule and timing
‚Ä¢ üë®‚Äçüè´ Teachers and instruction
‚Ä¢ üèÜ Certificates
‚Ä¢ üì± How to register
‚Ä¢ üíª Using Zoom

Or contact our support team via "Contact" page üòä`;
    }
  }

  generateQuickReplies(language: 'th' | 'en'): string[] {
    if (language === 'th') {
      return [
        '‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏û‡∏•‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ',
        '‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
        '‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô',
        '‡πÉ‡∏ö‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏ü‡∏¥‡πÄ‡∏Ñ‡∏ï',
        '‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
        '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°'
      ];
    } else {
      return [
        'Course pricing',
        'Class schedule', 
        'Teachers',
        'Certificates',
        'How to register',
        'Contact support'
      ];
    }
  }
}